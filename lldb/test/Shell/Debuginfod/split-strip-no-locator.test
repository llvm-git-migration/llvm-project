# REQUIRES: system-linux && native && target-x86_64

# Scenario 4 baseline:
# * A stripped, split binary, with symbols manually added and the
# * .dwp file located (automatically) sitting next to the binary.

# RUN: rm -rf %t
# RUN: mkdir -p %t

# RUN: yaml2obj %p/Inputs/bin-split-stripped.yaml -o %t/bin-split-stripped
# RUN: yaml2obj %p/Inputs/bin-split.yaml -o %t/bin-split
# RUN: yaml2obj %p/Inputs/bin-split-dwp.yaml -o %t/bin-split-stripped.dwp
# RUN: chmod a+x %t/bin-split-stripped
# RUN: chmod a+x %t/bin-split

# RUN: %lldb -o "settings set symbols.enable-external-lookup false" \
# RUN:       -o "target create %t/bin-split-stripped" \
# RUN:       -o "target symbols add %t/bin-split" \
# RUN:       -o "target modules dump separate-debug-info" \
# RUN:       -o "quit" \
# RUN:        2>&1 | FileCheck %s

# CHECK: Symbol file: {{.*}}/bin-split-stripped
# CHECK-NEXT: Type: "dwo"
# CHECK-NEXT: Dwo ID{{.*}}
# CHECK-NEXT: {{^[- ]+$}}
# CHECK-NEXT: {{0x[0-9a-f]+.* +.*}}/bin-split-stripped.dwp({{.*}}/bin-split.dwo){{ *$}}
