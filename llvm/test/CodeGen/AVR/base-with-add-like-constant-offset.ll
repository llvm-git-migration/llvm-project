; NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
; RUN: llc -mtriple=avr %s -start-before=avr-isel -o - -stop-after=avr-isel | FileCheck %s

define void @test(i16 %x, ptr addrspace(1) %o) {
  ; CHECK-LABEL: name: test
  ; CHECK: bb.0 (%ir-block.0):
  ; CHECK-NEXT:   liveins: $r25r24, $r23r22
  ; CHECK-NEXT: {{  $}}
  ; CHECK-NEXT:   [[COPY:%[0-9]+]]:dregs = COPY $r23r22
  ; CHECK-NEXT:   [[COPY1:%[0-9]+]]:dregs = COPY $r25r24
  ; CHECK-NEXT:   [[COPY2:%[0-9]+]]:ptrdispregs = COPY [[COPY]]
  ; CHECK-NEXT:   STDWPtrQRr [[COPY2]], 10, [[COPY1]] :: (store (s16) into %ir.addr, align 1, addrspace 1)
  ; CHECK-NEXT:   RET implicit $r1
  %int = ptrtoint ptr addrspace(1) %o to i16
  %or = or disjoint i16 %int, 10
  %addr = inttoptr i16 %or to ptr addrspace(1)
  store i16 %x, ptr addrspace(1) %addr
  ret void
}

