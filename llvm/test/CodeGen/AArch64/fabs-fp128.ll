; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 2
; RUN: llc -mtriple=aarch64 -verify-machineinstrs %s -o - | FileCheck %s --check-prefixes=CHECK,CHECK-SD
; RUN: llc -mtriple=aarch64 -global-isel=1 -global-isel-abort=2 -verify-machineinstrs %s -o - | FileCheck %s --check-prefixes=CHECK,CHECK-GI

; CHECK: warning: Instruction selection used fallback path for fabs_f128
; CHECK-NEXT: warning: Instruction selection used fallback path for fabs_v1f128
; CHECK-NEXT: warning: Instruction selection used fallback path for fabs_v2f128

define fp128 @fabs_f128(fp128 %a) {
; CHECK-LABEL: fabs_f128:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    str q0, [sp, #-16]!
; CHECK-NEXT:    .cfi_def_cfa_offset 16
; CHECK-NEXT:    ldrb w8, [sp, #15]
; CHECK-NEXT:    and w8, w8, #0x7f
; CHECK-NEXT:    strb w8, [sp, #15]
; CHECK-NEXT:    ldr q0, [sp], #16
; CHECK-NEXT:    ret
entry:
  %c = call fp128 @llvm.fabs.f128(fp128 %a)
  ret fp128 %c
}

define <1 x fp128> @fabs_v1f128(<1 x fp128> %a) {
; CHECK-LABEL: fabs_v1f128:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    str q0, [sp, #-16]!
; CHECK-NEXT:    .cfi_def_cfa_offset 16
; CHECK-NEXT:    ldrb w8, [sp, #15]
; CHECK-NEXT:    and w8, w8, #0x7f
; CHECK-NEXT:    strb w8, [sp, #15]
; CHECK-NEXT:    ldr q0, [sp], #16
; CHECK-NEXT:    ret
entry:
  %c = call <1 x fp128> @llvm.fabs.v1f128(<1 x fp128> %a)
  ret <1 x fp128> %c
}

define <2 x fp128> @fabs_v2f128(<2 x fp128> %a) {
; CHECK-LABEL: fabs_v2f128:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    stp q0, q1, [sp, #-32]!
; CHECK-NEXT:    .cfi_def_cfa_offset 32
; CHECK-NEXT:    ldrb w8, [sp, #15]
; CHECK-NEXT:    and w8, w8, #0x7f
; CHECK-NEXT:    strb w8, [sp, #15]
; CHECK-NEXT:    ldrb w8, [sp, #31]
; CHECK-NEXT:    and w8, w8, #0x7f
; CHECK-NEXT:    strb w8, [sp, #31]
; CHECK-NEXT:    ldp q0, q1, [sp], #32
; CHECK-NEXT:    ret
entry:
  %c = call <2 x fp128> @llvm.fabs.v2f128(<2 x fp128> %a)
  ret <2 x fp128> %c
}
;; NOTE: These prefixes are unused and the list is autogenerated. Do not add tests below this line:
; CHECK-GI: {{.*}}
; CHECK-SD: {{.*}}
