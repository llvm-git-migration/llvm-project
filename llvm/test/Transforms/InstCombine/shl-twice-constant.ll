; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -passes=instcombine -S | FileCheck %s

@c = external constant i8
@c2 = external constant i8

define i16 @testfunc() {
; CHECK-LABEL: @testfunc(
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[TMP0:%.*]] = shl nuw i64 1, ptrtoint (ptr @c2 to i64)
; CHECK-NEXT:    [[TMP1:%.*]] = shl i64 [[TMP0]], ptrtoint (ptr @c to i64)
; CHECK-NEXT:    [[TMP2:%.*]] = inttoptr i64 [[TMP1]] to ptr
; CHECK-NEXT:    [[TMP3:%.*]] = load i16, ptr [[TMP2]], align 1
; CHECK-NEXT:    ret i16 [[TMP3]]
;
entry:
  %0 = shl i64 1, ptrtoint (ptr @c2 to i64)
  %1 = shl i64 %0, ptrtoint (ptr @c to i64)
  %2 = inttoptr i64 %1 to ptr
  %3 = load i16, ptr %2, align 1
  ret i16 %3
}
