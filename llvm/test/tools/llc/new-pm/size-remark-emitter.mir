# REQUIRES: x86-registered-target

# RUN: llc -mtriple=x86_64-unknown-linux-gnu -filetype=null %s \
# RUN: -p dead-mi-elimination -pass-remarks-analysis='size-info' \
# RUN: -pass-remarks-output=%t.yaml < %s 2> %t; \
# RUN: cat %t %t.yaml | FileCheck %s

--- |
  source_filename = "size-remark-emitter.mir"
  target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128"
  target triple = "x86_64-unknown-linux-gnu"
  
  define void @test() {
  entry:
    unreachable
  }

...
---
name:            test
body:             |
  bb.0:
    %1:gr64 = MOV64ri 0
    %2:gr64 = MOV64ri 0
    $eax = COPY %1
    RET64 implicit $eax
...

# CHECK: --- !Analysis
# CHECK: Pass:            size-info
# CHECK: Name:            FunctionMISizeChange
# CHECK: Function:        test
# CHECK: Args:
# CHECK:   - Pass:            DeadMachineInstructionElimPass
# CHECK:   - String:          ': Function: '
# CHECK:   - Function:        test
# CHECK:   - String:          ': '
# CHECK:   - String:          'MI Instruction count changed from '
# CHECK:   - MIInstrsBefore:  '4'
# CHECK:   - String:          ' to '
# CHECK:   - MIInstrsAfter:   '3'
# CHECK:   - String:          '; Delta: '
# CHECK:   - Delta:           '-1'
# CHECK: ...
