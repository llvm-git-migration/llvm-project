RUN: llvm-readobj --coff-imports --coff-output-style=JSON --pretty-print %p/Inputs/imports.exe.coff-i386 | FileCheck -check-prefix=X86 %s
RUN: llvm-readobj --coff-imports --coff-output-style=JSON --pretty-print %p/Inputs/imports.exe.coff-x86-64 --coff-output-style=JSON --pretty-print | FileCheck -check-prefixes=X64  %s

X86:    "Import": {
X86-NEXT:      "Name": "KERNEL32.dll",
X86-NEXT:      "ImportLookupTableRVA": 8456,
X86-NEXT:      "ImportAddressTableRVA": 8192,
X86-NEXT:      "Symbols": [
X86-NEXT:        {
X86-NEXT:          "Name": "ExitProcess",
X86-NEXT:          "Ordinal": 337
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "GetProcAddress",
X86-NEXT:          "Ordinal": 669
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "FreeLibrary",
X86-NEXT:          "Ordinal": 414
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "GetLastError",
X86-NEXT:          "Ordinal": 592
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "RaiseException",
X86-NEXT:          "Ordinal": 1087
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "LoadLibraryExA",
X86-NEXT:          "Ordinal": 934
X86-NEXT:        }
X86-NEXT:      ]
X86-NEXT:    },
X86-NEXT:    "Import": {
X86-NEXT:      "Name": "USER32.dll",
X86-NEXT:      "ImportLookupTableRVA": 8484,
X86-NEXT:      "ImportAddressTableRVA": 8220,
X86-NEXT:      "Symbols": [
X86-NEXT:        {
X86-NEXT:          "Name": "MessageBoxA",
X86-NEXT:          "Ordinal": 582
X86-NEXT:        }
X86-NEXT:      ]
X86-NEXT:    },
X86-NEXT:    "Import": {
X86-NEXT:      "Name": "mydll.dll",
X86-NEXT:      "ImportLookupTableRVA": 8492,
X86-NEXT:      "ImportAddressTableRVA": 8228,
X86-NEXT:      "Symbols": [
X86-NEXT:        {
X86-NEXT:          "Name": "Func1",
X86-NEXT:          "Ordinal": 0
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "Func2",
X86-NEXT:          "Ordinal": 1
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "",
X86-NEXT:          "Ordinal": 3
X86-NEXT:        }
X86-NEXT:      ]
X86-NEXT:    },
X86-NEXT:    "DelayImport": {
X86-NEXT:      "Name": "lazyload.dll",
X86-NEXT:      "Attributes": 1,
X86-NEXT:      "ModuleHandle": 12316,
X86-NEXT:      "ImportAddressTable": 12304,
X86-NEXT:      "ImportNameTable": 8336,
X86-NEXT:      "BoundDelayImportTable": 8364,
X86-NEXT:      "UnloadDelayImportTable": 0,
X86-NEXT:      "Symbols": [
X86-NEXT:        {
X86-NEXT:          "Name": "Func5",
X86-NEXT:          "Ordinal": 0,
X86-NEXT:          "Address": 4198515
X86-NEXT:        },
X86-NEXT:        {
X86-NEXT:          "Name": "Func4",
X86-NEXT:          "Ordinal": 0,
X86-NEXT:          "Address": 4198482
X86-NEXT:        }
X86-NEXT:      ]
X86-NEXT:    }
X86-NEXT:  }


X64:    "Import": {
X64-NEXT:      "Name": "KERNEL32.dll",
X64-NEXT:      "ImportLookupTableRVA": 8560,
X64-NEXT:      "ImportAddressTableRVA": 8192,
X64-NEXT:      "Symbols": [
X64-NEXT:        {
X64-NEXT:          "Name": "ExitProcess",
X64-NEXT:          "Ordinal": 343
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "GetProcAddress",
X64-NEXT:          "Ordinal": 676
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "FreeLibrary",
X64-NEXT:          "Ordinal": 420
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "GetLastError",
X64-NEXT:          "Ordinal": 598
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "RaiseException",
X64-NEXT:          "Ordinal": 1091
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "LoadLibraryExA",
X64-NEXT:          "Ordinal": 937
X64-NEXT:        }
X64-NEXT:      ]
X64-NEXT:    },
X64-NEXT:    "Import": {
X64-NEXT:      "Name": "USER32.dll",
X64-NEXT:      "ImportLookupTableRVA": 8616,
X64-NEXT:      "ImportAddressTableRVA": 8248,
X64-NEXT:      "Symbols": [
X64-NEXT:        {
X64-NEXT:          "Name": "MessageBoxA",
X64-NEXT:          "Ordinal": 586
X64-NEXT:        }
X64-NEXT:      ]
X64-NEXT:    },
X64-NEXT:    "Import": {
X64-NEXT:      "Name": "mydll.dll",
X64-NEXT:      "ImportLookupTableRVA": 8632,
X64-NEXT:      "ImportAddressTableRVA": 8264,
X64-NEXT:      "Symbols": [
X64-NEXT:        {
X64-NEXT:          "Name": "Func1",
X64-NEXT:          "Ordinal": 0
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "Func2",
X64-NEXT:          "Ordinal": 1
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "",
X64-NEXT:          "Ordinal": 3
X64-NEXT:        }
X64-NEXT:      ]
X64-NEXT:    },
X64-NEXT:    "DelayImport": {
X64-NEXT:      "Name": "lazyload.dll",
X64-NEXT:      "Attributes": 1,
X64-NEXT:      "ModuleHandle": 12328,
X64-NEXT:      "ImportAddressTable": 12304,
X64-NEXT:      "ImportNameTable": 8416,
X64-NEXT:      "BoundDelayImportTable": 8456,
X64-NEXT:      "UnloadDelayImportTable": 0,
X64-NEXT:      "Symbols": [
X64-NEXT:        {
X64-NEXT:          "Name": "Func5",
X64-NEXT:          "Ordinal": 0,
X64-NEXT:          "Address": 5368713457
X64-NEXT:        },
X64-NEXT:        {
X64-NEXT:          "Name": "Func4",
X64-NEXT:          "Ordinal": 0,
X64-NEXT:          "Address": 5368713318
X64-NEXT:        }
X64-NEXT:      ]
X64-NEXT:    }
X64-NEXT:  }
